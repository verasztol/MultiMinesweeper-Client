<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
<script>
	myName = "John" + Date.now();
	socket = io.connect('https://multi-minesweeper.herokuapp.com');//('http://localhost:3000');
	socket.on('connect', function(){
		console.log("connected");
		socket.emit('authentication', {userName: myName});
		socket.on('user.added', function(data) {
			console.log("added", data);
		});
		socket.on('user.error', function(data) {
			console.log("error", data);
		});
		socket.on('game.error', function(data) {
			console.log("error", data);
		});
		socket.on('user.listed', function(data) {
			console.log("listed", data);
		});
		socket.on('user.wantPlay', function(data) {
			console.log("user.wantPlay", data);
			challenger = data.challengerName;
		});
		socket.on('user.declinedPlay', function(data) {
			console.log("user.declinedPlay", data);
		});
		socket.on('user.acceptedPlay', function(data) {
			console.log("user.acceptedPlay", data);
			socket.emit("game.start");
		});
		socket.on('game.started', function(data) {
			console.log("game.started", data);
		});
		socket.on('user.left', function() {
			console.log("your opponent left");
		});
		socket.on('game.marked', function(data) {
			console.log("marked", data);
		});
		socket.on('game.shooted', function(data) {
			console.log("shooted", data);
		});
		socket.on('game.end', function(data) {
			console.log("end", data);
			if(data.winner == myName) {
				console.log("WINNER");
			}
			else {
				console.log("LOSER", data);
			}
		});
	});
	
	function getUsers() {
		socket.emit('user.list');
	}
	
	function getOpponent() {
		var tmp = document.getElementById("enemy");
		console.log(tmp.value);
		socket.emit('user.select', {userName: tmp.value});
	}
	
	function accept() {
		socket.emit('user.answerPlay', {userName: challenger, answer: "yes"});
	}
	
	function decline() {
		socket.emit('user.answerPlay', {userName: challenger, answer: "no"});
	}
	
	function mark() {
		var tmpX = document.getElementById("markX") || 1;
		var tmpY = document.getElementById("markY") || 1;
		console.log(tmpX.value, tmpY.value);
		socket.emit('game.mark', {mark: {x:tmpX.value, y:tmpY.value}});
	}
	
	function shot() {
		var tmpX = document.getElementById("shotX") || 2;
		var tmpY = document.getElementById("shotY") || 2;
		console.log(tmpX.value, tmpY.value);
		socket.emit('game.shot', {shot: {x:tmpX.value, y:tmpY.value}});
	}
</script>

<button onclick="getUsers()">
	get users
</button>

<input id="enemy"></input>
<button onclick="getOpponent()">
	get opponent
</button>

<button onclick="accept()">
	accept
</button>

<button onclick="decline()">
	decline
</button>

<br>
<input id="markX" type="number"></input>
<input id="markY" type="number"></input>
<button onclick="mark()">
	mark
</button>

<br>
<input id="shotX" type="number"></input>
<input id="shotY" type="number"></input>
<button onclick="shot()">
	shot
</button>